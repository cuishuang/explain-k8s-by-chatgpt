# File: pkg/controller/statefulset/stateful_set_control.go

对于Kubernetes来说，StatefulSet是一种特殊的控制器，它可以用来控制部署有状态应用程序的方式。pkg/controller/statefulset/stateful_set_control.go这个文件就是StatefulSet控制器的核心逻辑实现。

_这几个变量分别有什么作用？

- 忽略下划线符号，没有任何特殊用途。

StatefulSetControlInterface作用

StatefulSetControlInterface是一个定义了StatefulSet控制器接口方法的接口类型，主要包括创建、更新、删除、获取状态、获取历史记录等方法。这个接口可以让其他部分的代码调用StatefulSet控制器的方法，从而实现StatefulSet的管理。

defaultStatefulSetControl结构体作用

defaultStatefulSetControl是一个默认的StatefulSet控制器。它实现了StatefulSetControlInterface接口，并提供了若干方法来管理StatefulSet。如果需要管理StatefulSet，可以通过调用这个结构体中的方法来实现。

NewDefaultStatefulSetControl函数作用

NewDefaultStatefulSetControl函数用于创建一个默认的StatefulSet控制器，返回的是一个StatefulSetControlInterface接口的实例。

UpdateStatefulSet函数作用

UpdateStatefulSet函数用于更新一个StatefulSet对象。它的参数包括原始的StatefulSet对象和新的StatefulSet对象。如果新旧对象不同，就会调用StatefulSet的Update方法更新对象。

performUpdate函数作用

performUpdate函数用于更新一个StatefulSet对象。它首先会调用UpdateStatefulSet函数来更新状态，然后根据InvariantEstablished来判断是否需要进一步更新。如果需要，则会调用updateStatefulSetAfterInvariantEstablished函数来更新状态。

ListRevisions函数作用

ListRevisions函数用于返回给定StatefulSet对象的历史记录。它会根据RevisionHistoryLimit来限制返回的历史记录数量。

AdoptOrphanRevisions函数作用

AdoptOrphanRevisions函数用于将孤立的Revision添加到StatefulSet对象的历史记录中。

truncateHistory函数作用

truncateHistory函数用于删除StatefulSet对象的旧历史记录。

getStatefulSetRevisions函数作用

getStatefulSetRevisions函数用于获取给定StatefulSet对象的历史记录。

updateStatefulSet函数作用

updateStatefulSet函数用于更新给定StatefulSet对象的状态。

updateStatefulSetAfterInvariantEstablished函数作用

updateStatefulSetAfterInvariantEstablished函数用于在InvariantEstablished条件下更新状态。如果新旧状态不同，就会更新对象并返回true，否则返回false。

updateStatefulSetStatus函数作用

updateStatefulSetStatus函数用于更新指定StatefulSet对象的状态，并执行必要的状态转换。如果转换成功，就会返回true，否则返回false。

