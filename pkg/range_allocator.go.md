# File: pkg/controller/nodeipam/ipam/range_allocator.go

pkg/controller/nodeipam/ipam/range_allocator.go这个文件是Kubernetes项目中的一个IP地址分配器，它负责管理Kubernetes集群中的节点IP地址。

rangeAllocator中定义了三个结构体：CIDRRangeAllocator、CIDRRange和CIDRNode。CIDRRangeAllocator是IP地址分配器的主要控制器，它管理所有CIDRRange和CIDRNode。CIDRRange是一个CIDR块，它是IP地址分配的基本单位。CIDRNode是CIDRRange中的一个IP地址节点。

NewCIDRRangeAllocator函数用于创建一个CIDRRangeAllocator对象。Run函数是IP地址分配器的入口点，它启动IP地址分配器并等待分配请求。worker函数是IP地址分配器的核心逻辑，在分配IP地址时被调用。

insertNodeToProcessing函数用于将CIDRNode添加到IP地址分配器中进行分配。removeNodeFromProcessing函数用于从IP地址分配器中移除CIDRNode。

occupyCIDRs函数用于占据CIDRRange中的一个或多个CIDR块。AllocateOrOccupyCIDR函数用于为节点分配一个CIDR块和一个IP地址。

ReleaseCIDR函数用于释放CIDRRange中的一个CIDR块，并将其中的IP地址置为空闲状态。filterOutServiceRange函数用于过滤出所有被服务使用的CIDR块。updateCIDRsAllocation函数用于更新CIDR块的分配状态。

总之，rangeAllocator是Kubernetes中非常重要的一个模块，它实现了IP地址的自动分配和管理，并确保Kubernetes集群中节点IP地址的唯一性和正确性。

