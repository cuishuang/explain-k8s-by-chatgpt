# File: pkg/controller/serviceaccount/tokens_controller.go

pkg/controller/serviceaccount/tokens_controller.go文件是kubernetes中用于处理serviceaccount的token操作的一个控制器。具体来说，该控制器会根据serviceaccount的变化，自动处理token的创建、更新和删除等操作。下面将详细介绍该文件中的各个部分。

RemoveTokenBackoff变量是一个指数退避器，用于控制token的撤销操作，避免过于频繁的调用。

TokensControllerOptions结构体用于存储tokens_controller的各种配置选项，例如队列大小、worker数量等。

TokensController结构体是tokens_controller的主体，包含了各种必要的参数和函数，例如队列、锁、数据库等。

serviceAccountQueueKey和secretQueueKey分别是serviceaccount和secret队列的键。

NewTokensController函数用于创建tokens_controller实例。

Run函数开启tokens_controller实例的循环，一旦队列中有新的操作，就会根据情况进行相应的处理。

queueServiceAccountSync和queueServiceAccountUpdateSync函数用于向serviceaccount队列中添加对象或对象更新操作。

retryOrForget函数用于处理失败的操作。

queueSecretSync和queueSecretUpdateSync函数用于向secret队列中添加对象或对象更新操作。

syncServiceAccount和syncSecret函数用于同步serviceaccount和secret的操作。

deleteTokens和deleteToken函数用于删除指定的token。

secretUpdateNeeded函数用于判断是否需要更新secret。

generateTokenIfNeeded函数用于判断是否需要生成新的token。

removeSecretReference函数用于删除相关的secret引用。

getServiceAccount、getSecret、listTokenSecrets、getSecretReferences四个函数用于获取相应的信息。

makeServiceAccountKey、parseServiceAccountKey、makeSecretQueueKey、parseSecretQueueKey、makeCacheKey五个函数用于用于处理serviceaccount和secret相关的key等操作。

