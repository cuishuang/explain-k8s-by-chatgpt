# File: pkg/controller/daemon/daemon_controller.go

pkg/controller/daemon/daemon_controller.go这个文件的作用是控制DaemonSet的运行和管理。DaemonSet是一种Kubernetes的控制器，它确保在给定节点上运行具有指定标签的一个副本。DaemonSet通常用于运行具有守护进程特性的Pod，如日志收集器、监视器等。DaemonController就是用来管理DaemonSet的。

在这个文件中，controllerKind这几个变量用于指定控制器的名称和api版本。DaemonSetsController是一个结构体，用于存储DaemonSet控制器的状态信息。podByCreationTimestampAndPhase是一个结构体，用于存储Pod的状态信息。

NewDaemonSetsController函数用于创建一个新的DaemonSet控制器。addDaemonset函数用于将一个新的DaemonSet加入到控制器中，updateDaemonset函数用于更新控制器中已有的DaemonSet，deleteDaemonset函数用于删除控制器中的DaemonSet。Run函数用于启动DaemonSet控制器的主循环。

runWorker函数用于在控制器的工作队列中获取下一项工作，并执行相应的操作。processNextWorkItem函数用于处理工作队列中下一项工作。enqueue函数用于将一个新的工作项加入到工作队列中。enqueueDaemonSetAfter函数用于将一个新的DaemonSet的工作项加入到工作队列中。

getDaemonSetsForPod函数和getDaemonSetsForHistory函数分别用于获取与Pod或历史记录相关联的DaemonSet。addHistory函数用于将一个新的历史记录加入到控制器中，updateHistory函数用于更新控制器中的历史记录，deleteHistory函数用于删除控制器中的历史记录。addPod函数用于将一个新的Pod加入到控制器中，updatePod函数用于更新控制器中已有的Pod，deletePod函数用于删除控制器中的Pod。

addNode函数用于将一个新的节点加入到控制器中，nodeInSameCondition函数用于检查两个节点是否处于相同的状态，shouldIgnoreNodeUpdate函数用于判断是否应该忽略节点的更新操作，updateNode函数用于更新控制器中已有的节点信息。

getDaemonPods函数用于获取所有与DaemonSet相关联的Pod，getNodesToDaemonPods函数用于获取与DaemonPod关联的节点，resolveControllerRef函数用于解析控制器引用，podsShouldBeOnNode函数用于判断一个Pod是否应该在一个节点上运行，updateDaemonSet函数用于更新一个DaemonSet的状态信息。manage函数用于管理与DaemonSet相关联的Pod和节点。syncNodes函数用于同步控制器中的节点信息，storeDaemonSetStatus函数用于将DaemonSet的状态存储到etcd中，updateDaemonSetStatus函数用于更新DaemonSet的状态信息，syncDaemonSet函数用于同步DaemonSet的状态信息。

NodeShouldRunDaemonPod函数用于判断一个节点是否应该运行一个DaemonPod，predicates函数用于过滤Pod，NewPod函数用于创建一个新的Pod，Len函数用于获取队列的长度，Swap函数用于交换队列中两个元素的位置，Less函数用于比较两个队列元素的大小，failedPodsBackoffKey函数用于获取备份pod的键，getUnscheduledPodsWithoutNode函数用于获取未安排节点的Pod。

